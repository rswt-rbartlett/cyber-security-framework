<img src="/Levels/twt-logo.png" height="100">

# Implement appropriate mitigations
# Step 6. Vulnerability management

## Update systems
> Cyber Essentials **Secure Configuration** requirements (questions A6.1 & 6.2)

You should ensure that all software and hardware (including routers, firewalls and network equipment) are supported by the vendor, and receiving software updates, in particular security bugfixes.

> [!IMPORTANT]
> An [article](https://research.nccgroup.com/2022/08/04/top-of-the-pops-three-common-ransomware-entry-techniques/) by NCC Group on the initial entry methods of ransomware attacks in the six months to August 2022 revealed known vulnerabilities in Microsoft Exchange and Firewalls as number 1 and 2, and those vulnerabilities had been patched for at least a year at the point they were exploited.

Below are instructions on configuring automatic updates for the most commonly used devices, platforms and applications.  
> Cyber Essentials **Secure Configuration** requirements (questions A6.4-6.4.2)

**Recommendation**: For most computer, laptops, smartphones and tablets the best option is to allow the system to automatically download and install updates.  This has a lower overhead and manually pushing updates, but does carry a small risk of disruption if an update is flawed, however this is lower than the risk of security incidents caused by out of date software.

### Update Windows
- [Update Windows 10/11 manually](https://support.microsoft.com/en-gb/windows/update-windows-3c5ae7fc-9fb6-9af1-1984-b5e0412c556a?WT.mc_id=365AdminCSH_gethelp#WindowsVersion=Windows_10)
- [Deploy Windows 10 updates with Configuration Manager](https://learn.microsoft.com/en-gb/windows/deployment/update/deploy-updates-configmgr)
- [Deploy Windows 10 updates with Intune](https://learn.microsoft.com/en-gb/windows/deployment/update/deploy-updates-intune)
- [Deploy Windows client updates using Windows Server Update Services (WSUS)](https://learn.microsoft.com/en-gb/windows/deployment/update/waas-manage-updates-wsus)
- [Use Group Policy to configure Windows Update for Business](https://learn.microsoft.com/en-gb/windows/deployment/update/waas-wufb-group-policy)

### Update Mac OS
- [Keep your Mac up to date](https://support.apple.com/en-gb/guide/mac-help/mchlpx1065/mac)

### Update iOS
- [Turn on or turn off automatic updates on iOS](https://support.apple.com/en-gb/HT202180)

### Update Android
- [How to update all Android apps automatically](https://support.google.com/googleplay/answer/113412?hl=en-GB)
- Update your Samsung phone (when I can find the support page)

## Update third-party applications
> Cyber Essentials **Secure Configuration** requirements (questions A6.5-6.5.2)

As well as Windows and Office (which can both be updated using Windows Update) third party applications such as web browsers, PDF readers and GIS software also need to be kept up to date with the latest security bugfixes.  Browers, email clients and PDF readers in particular have frequently been used by attackers so are particularly important to keep updated. There are multiple options for third party software updates listed below, some of which are free.

### Update web browsers
Below are references to the automatic configuration for the most popular web browsers.
- [Microsoft Edge](https://learn.microsoft.com/en-us/deployedge/microsoft-edge-update-policies)
- [Google Chrome](https://support.google.com/chrome/a/answer/6350036?hl=en)
- [Mozilla Firefox](https://support.mozilla.org/en-US/kb/enable-background-updates-firefox-windows)
- [Safari for Mac](https://support.apple.com/en-gb/HT204416)

### Update other applications
- Using [Microsoft Configuration Manager](https://learn.microsoft.com/en-us/mem/configmgr/sum/deploy-use/third-party-software-updates)
- Using [Ninite Free](https://ninite.com/)
- Using [Chocolatey Open Source](https://chocolatey.org/)
 
## Manage legacy systems
> Cyber Essentials **Secure Configuration** requirements (questions A6.6, 6.7)

If there are systems which are no longer supported by the vendor and those systems cannot be upgraded, you should ideally migrate to a replacement service which is supported.  **Continuing to run legacy unsupported systems exposes the organisation to a continual risk until the system is replaced**.  The risks may be direct risks (a security vulnerability in the legacy system is used by an attacker to gain access) or indirect (you have to run a Remote Desktop Connection to the system for remote workers which exposes your network).

If you accept the risks of running the legacy system, take the following precautions to reduce that risk:
1. Segregate them from the rest of your systems using network and/or firewalls controls
2. Block internet access from the system except for specific permitted sites (e.g. for updates or file transfer)
3. Reduce access to the system to your local office network or your VPN address pool.
4. [Reduce the attack surface](./Step-5-Architecture-and-configuration.md#reduce-attack-surface) of the system as far as possible
5. Monitor all access to the system to ensure you're aware of any intrusion

## Scan for vulnerabilities
With all security controls it is important to verify that the controls are effective.  Vulnerability scanning provides that verification, using a software package which scans systems to verify that they are free of known vulnerabilities. Scans can be unauthenticated (typically used to assess the network perimeter) and authenticated (which is used to check internal systems).  Vulnerability scanning can find vulnerabilities caused by both out of date software and some configuration errors (e.g. default passwords or open permissions).

There are two options for Trusts to check their networks for vulnerabilities:
1. Take advantage of the vulnerability scanning service from RSWT, based on Tenable Nessus Pro.  Contact the [Strategic Lead for Information Security](mailto:rbartlett@wildlifetrusts.org) for more information.
2. Apply for the [free Nessus subscription](https://www.tenable.com/about-tenable/tenable-in-the-community/tenable-charitable-organization-subscription-program) for charities, and setup your own Nessus Pro vulnerability scanning. 

## Conduct penetration testing 

In addition to vulnerability scanning Trusts should also undertake 'penetration testing', which is where a specialist attempts to break into your network using the same tools and techniques as a hacker.  When done properly these can either provide a very high level of assurance, or identify important vulnerabilities which might otherwise lead to a security incident.  Some insurance companies now list an annual penetration test as a prerequisite for cyber insurance, and funders also use this as a measure of an organisations security.

The Strategic Lead for Information Security at RSWT can provide some penetration testing services, however this is only a rudimentary step before a penetration test from a qualified external third party.  A potential for a central purchasing framework for penetration testing services is being explored. If you chose to engage your own penetration testing it is recommended you follow the principles below:
1. The person or organisation providing penetration testing should be independent from the organisation responsible for the security of the system (i.e. don't get a company to mark it's own homework).
2. The organisation should be [CREST accredited](https://www.crest-approved.org/members/?filter_offices_10717=United%20Kingdom&filter_accredited_services_10717=Penetration%20Testing).
3. The scope should not artificially exclude parts of your network or systems, though it can exclude certain activities (e.g. physical penetration testing like breaking into a data centre). Real world hackers  will not exclude anything they can access from their attack.
4. If any part of the test will be on infrastructure you are not responsible (e.g. a cloud service or an RSWT provided service) you should consult with the service provider in advance to prevent service disruption or breach of terms and conditions.

## Return to [Step 5. Architecture and configuration](./Step-05-Architecture-and-Configuration.md) or continue to [Step 7. Identity and access management](./Step-07-Identity-and-Access-Management.md)